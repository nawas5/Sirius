[v_l, v_d] = speed(pi/2, 5, pi/2, pi/3, pi/2, 0.1, 0.3, 0.2, -0.1, 0.6);  
disp('linear speed');
disp(v_l(1:3, 1));  
disp('angular velocity');
disp(v_d); 
 
 
 
  
function [v_l, v_d] = speed(q1, q2, q3, q4, q5, q11, q21, q31, q41, q51)  
    v_l = zeros(3);  
    v_d = zeros(3);  
    v_l(1) = q41*((33*sin(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064) + sin(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064)))/8 - (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064) - sin(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064)))/8) - q11*((163936000800709863*cos(q1))/649037107316853453566312041152512 - (33*sin(q4 - pi/2)*(cos(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1)) + sin(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2))))/8 + (59*cos(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1)))/8 + (114258424800494753*cos(q1)*sin(q2 - pi/2))/324518553658426726783156020576256 + (23*cos(q2 - pi/2)*sin(q1))/4 + (59*sin(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2)))/8 + (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2)) - sin(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1))))/8) - q21*((59*cos(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064))/8 - (33*sin(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064) + sin(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064)))/8 + (23*cos(q1)*sin(q2 - pi/2))/4 + (114258424800494753*cos(q2 - pi/2)*sin(q1))/324518553658426726783156020576256 + (59*sin(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064))/8 + (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064) - sin(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064)))/8) - q31*((59*cos(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064))/8 - (33*sin(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064) + sin(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064)))/8 + (59*sin(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064))/8 + (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064) - sin(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064)))/8); 
    v_l(2) = - q41*((33*sin(q4 - pi/2)*(cos(q3+pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2)) - sin(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1))))/8 + (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1)) + sin(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2))))/8) - q11*((163936000800709863*sin(q1))/649037107316853453566312041152512 + (33*sin(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) -(4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064) - sin(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064)))/8 - (23*cos(q1)*cos(q2 - pi/2))/4 - (59*cos(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064))/8 + (59*sin(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064))/8 + (114258424800494753*sin(q1)*sin(q2 - pi/2))/324518553658426726783156020576256 + (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*(cos(q1)*sin(q2 - pi/2) + (4967757600021511*cos(q2 - pi/2)*sin(q1))/81129638414606681695789005144064) + sin(q3 + pi/2)*(cos(q1)*cos(q2 - pi/2) - (4967757600021511*sin(q1)*sin(q2 - pi/2))/81129638414606681695789005144064)))/8) - q21*((33*sin(q4 - pi/2)*(cos(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2)) - sin(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1))))/8 - (114258424800494753*cos(q1)*cos(q2 - pi/2))/324518553658426726783156020576256 - (59*cos(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2)))/8 + (59*sin(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1)))/8 + (23*sin(q1)*sin(q2 - pi/2))/4 + (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1)) + sin(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2))))/8) - q31*((33*sin(q4 - pi/2)*(cos(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2)) - sin(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1))))/8 - (59*cos(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2)))/8 + (59*sin(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1)))/8 + (33*cos(q4 - pi/2)*(cos(q3 + pi/2)*((4967757600021511*cos(q1)*sin(q2 - pi/2))/81129638414606681695789005144064 + cos(q2 - pi/2)*sin(q1)) + sin(q3 + pi/2)*((4967757600021511*cos(q1)*cos(q2 - pi/2))/81129638414606681695789005144064 - sin(q1)*sin(q2 - pi/2))))/8); 
    v_l(3) = q21*((33*cos(q4 - pi/2)*(cos(q2 - pi/2)*sin(q3 + pi/2) + cos(q3 + pi/2)*sin(q2 - pi/2)))/8 - (23*cos(q2 - pi/2))/4 + (33*sin(q4 - pi/2)*(cos(q2 - pi/2)*cos(q3 + pi/2) - sin(q2 - pi/2)*sin(q3 + pi/2)))/8 - (59*cos(q2 - pi/2)*cos(q3 + pi/2))/8 + (59*sin(q2 - pi/2)*sin(q3 + pi/2))/8) + q41*((33*cos(q4 - pi/2)*(cos(q2 - pi/2)*sin(q3 + pi/2) + cos(q3 + pi/2)*sin(q2 - pi/2)))/8 + (33*sin(q4 - pi/2)*(cos(q2 - pi/2)*cos(q3 + pi/2) - sin(q2 - pi/2)*sin(q3 + pi/2)))/8) + q31*((33*cos(q4 - pi/2)*(cos(q2 - pi/2)*sin(q3 + pi/2) + cos(q3 + pi/2)*sin(q2 - pi/2)))/8 + (33*sin(q4 - pi/2)*(cos(q2 - pi/2)*cos(q3 + pi/2) - sin(q2 - pi/2)*sin(q3 + pi/2)))/8 - (59*cos(q2 - pi/2)*cos(q3 + pi/2))/8 + (59*sin(q2 - pi/2)*sin(q3 + pi/2))/8); 
    T01 = DH(0, -pi / 2, 3, q1);  
    R12 = DH(5.75, 0, 0, -pi / 2 +q2);  
    T02 = T01 * R12;  
    R23 = DH(7.375, 0, 0, pi / 2 + q3);  
    T03 = T02 * R23;  
    R34 = DH(0, -pi / 2, 0, -pi / 2 + q4);  
    T04 = T03 * R34;  
    R45 = DH(0, 0, 4.125, q5);  
    T05 = T04 * R45; 
    Z0 = [0;0;1]; 
    Z1 = T01(1:3,3); 
    Z2=T02(1:3,3); 
    Z3=T03(1:3,3); 
    Z4=T04(1:3,3); 
    w1 = Z0*q11; 
    w2 = Z1*q21; 
    w3 = Z2*q31; 
    w4 = Z3*q41; 
    w5 = Z4*q51; 
    v_d = w1 + w2 + w3 + w4 + w5; 
end  
  
 
  
function [x] = DH(r,a,d,Q)    
    x(1,1) = cos(Q);  
    x(1,2) = -sin(Q) * cos(a);  
    x(1,3) = sin(Q) * sin(a);  
    x(1,4) = r * cos(Q);  
    x(2,1) = sin(Q);  
    x(2,2) = cos(Q) * cos(a);  
    x(2,3) = -cos(Q) * sin(a);  
    x(2,4) = r * sin(Q);  
    x(3,1) = 0;  
    x(3,2) = sin(a);  
    x(3,3) = cos(a);  
    x(3,4) = d;  
    x(4,1) = 0;  
    x(4,2) = 0;  
    x(4,3) = 0;  
    x(4,4) = 1;  
end